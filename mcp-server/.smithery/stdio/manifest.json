{
  "type": "stdio",
  "runtime": "node",
  "serverCard": {
    "serverInfo": {
      "name": "security-scanner",
      "version": "1.0.0"
    },
    "tools": [
      {
        "name": "scan_security",
        "description": "Scan a file for security vulnerabilities and return issues with suggested fixes",
        "inputSchema": {
          "type": "object",
          "properties": {
            "file_path": {
              "type": "string",
              "description": "Path to the file to scan"
            }
          },
          "required": [
            "file_path"
          ],
          "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "execution": {
          "taskSupport": "forbidden"
        }
      },
      {
        "name": "fix_security",
        "description": "Scan a file and return the fixed content with all security issues resolved",
        "inputSchema": {
          "type": "object",
          "properties": {
            "file_path": {
              "type": "string",
              "description": "Path to the file to fix"
            }
          },
          "required": [
            "file_path"
          ],
          "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "execution": {
          "taskSupport": "forbidden"
        }
      },
      {
        "name": "list_security_rules",
        "description": "List all available security fix templates and their descriptions",
        "inputSchema": {
          "type": "object",
          "properties": {},
          "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "execution": {
          "taskSupport": "forbidden"
        }
      },
      {
        "name": "check_package",
        "description": "Check if a package name is legitimate or potentially hallucinated (AI-invented)",
        "inputSchema": {
          "type": "object",
          "properties": {
            "package_name": {
              "type": "string",
              "description": "The package name to verify"
            },
            "ecosystem": {
              "type": "string",
              "enum": [
                "dart",
                "perl",
                "raku",
                "npm",
                "pypi",
                "rubygems",
                "crates"
              ],
              "description": "The package ecosystem (dart=pub.dev, perl=CPAN, raku=raku.land, npm=npmjs, pypi=PyPI, rubygems=RubyGems, crates=crates.io)"
            }
          },
          "required": [
            "package_name",
            "ecosystem"
          ],
          "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "execution": {
          "taskSupport": "forbidden"
        }
      },
      {
        "name": "scan_packages",
        "description": "Scan code for package imports and check for hallucinated (AI-invented) packages",
        "inputSchema": {
          "type": "object",
          "properties": {
            "file_path": {
              "type": "string",
              "description": "Path to the file to scan"
            },
            "ecosystem": {
              "type": "string",
              "enum": [
                "dart",
                "perl",
                "raku",
                "npm",
                "pypi",
                "rubygems",
                "crates"
              ],
              "description": "The package ecosystem (dart=pub.dev, perl=CPAN, raku=raku.land, npm=npmjs, pypi=PyPI, rubygems=RubyGems, crates=crates.io)"
            }
          },
          "required": [
            "file_path",
            "ecosystem"
          ],
          "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "execution": {
          "taskSupport": "forbidden"
        }
      },
      {
        "name": "list_package_stats",
        "description": "List statistics about loaded package lists for hallucination detection",
        "inputSchema": {
          "type": "object",
          "properties": {},
          "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "execution": {
          "taskSupport": "forbidden"
        }
      },
      {
        "name": "scan_agent_prompt",
        "description": "Scan a prompt/instruction for potential malicious intent before execution. Returns risk assessment and recommended action (BLOCK/WARN/LOG/ALLOW).",
        "inputSchema": {
          "type": "object",
          "properties": {
            "prompt_text": {
              "type": "string",
              "description": "The prompt or instruction text to analyze"
            },
            "context": {
              "description": "Optional context for better analysis",
              "type": "object",
              "properties": {
                "previous_messages": {
                  "description": "Previous conversation messages for multi-turn detection",
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "sensitivity_level": {
                  "description": "Sensitivity level - high means more strict, low means more permissive",
                  "type": "string",
                  "enum": [
                    "high",
                    "medium",
                    "low"
                  ]
                }
              }
            }
          },
          "required": [
            "prompt_text"
          ],
          "$schema": "http://json-schema.org/draft-07/schema#"
        },
        "execution": {
          "taskSupport": "forbidden"
        }
      }
    ],
    "resources": [],
    "prompts": []
  },
  "source": {
    "commit": "d24d6d6bd3c2ebb1ce856a5df681572210137e8b",
    "branch": "feature/merge-ast-engine"
  }
}